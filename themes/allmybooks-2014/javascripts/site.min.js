"use strict";function updateFinishedList(a){jQuery("#loading-container").toggle(),jQuery.ajax({type:"POST",url:templateDirectory+"/php/save-list.php",data:"list=fin&id="+a,success:function(a){jQuery("#loading-container").toggle(),a.length&&jQuery("#logged-out-warning").addClass("animate-open").removeClass("animate-close").children("p").text(a)}})}function updateCurrentList(a){jQuery("#loading-container").toggle(),jQuery.ajax({type:"POST",url:templateDirectory+"/php/save-list.php",data:"list=cur&id="+a,success:function(a){jQuery("#loading-container").toggle(),a.length&&jQuery("#logged-out-warning").addClass("animate-open").removeClass("animate-close").children("p").text(a)}})}function updateFutureList(){var a=[],b=1;jQuery("#future-read-list li").each(function(){var c=jQuery(this).data("order");c!=b&&a.push(this.id+":"+b),b++});var c=a.join(",");jQuery("#loading-container").toggle(),jQuery.ajax({type:"POST",url:templateDirectory+"/php/save-list.php",data:"list=fut&future_list="+c,success:function(a){jQuery("#loading-container").toggle(),a.length&&jQuery("#logged-out-warning").addClass("animate-open").removeClass("animate-close").children("p").text(a)}})}function checkVisible(a,b){b=b||"visible";var c=$(window).height(),d=$(window).scrollTop(),e=$(a).offset().top,f=$(a).height();return"visible"===b?c+d>e&&e>d-f:"above"===b?c+d>e:void 0}function visibleLooper(){jQuery("#future-read-list.expanded").length&&jQuery("#future-read-list .overflow").each(function(){if(!jQuery(this).hasClass("animate")&&checkVisible(jQuery(this),"above")){var a=Math.floor(700*Math.random());jQuery(this).delay(a).queue(function(){jQuery(this).addClass("animate").dequeue()})}})}var $=jQuery;!function(a){var b,c,d=a();a.fn.sortable=function(e){var f=String(e);return e=a.extend({connectWith:!1,placeholder:null,dragImage:null},e),this.each(function(){if("reload"===f&&a(this).children(e.items).off("dragstart.h5s dragend.h5s selectstart.h5s dragover.h5s dragenter.h5s drop.h5s"),/^enable|disable|destroy$/.test(f)){var g=a(this).children(a(this).data("items")).attr("draggable","enable"===f);return void("destroy"===f&&(a(this).off("sortupdate"),a(this).removeData("opts"),g.add(this).removeData("connectWith items").off("dragstart.h5s dragend.h5s selectstart.h5s dragover.h5s dragenter.h5s drop.h5s").off("sortupdate")))}var h=a(this).data("opts");"undefined"==typeof h?a(this).data("opts",e):e=h;var i,j,k,l,m=a(this).children(e.items),n=null===e.placeholder?a("<"+(/^ul|ol$/i.test(this.tagName)?"li":"div")+' class="sortable-placeholder">'):a(e.placeholder).addClass("sortable-placeholder");m.find(e.handle).mousedown(function(){i=!0}).mouseup(function(){i=!1}),a(this).data("items",e.items),d=d.add(n),e.connectWith&&a(e.connectWith).add(this).data("connectWith",e.connectWith),m.attr("role","option"),m.attr("aria-grabbed","false"),m.attr("draggable","true").on("dragstart.h5s",function(d){if(d.stopImmediatePropagation(),e.handle&&!i)return!1;i=!1;var f=d.originalEvent.dataTransfer;f.effectAllowed="move",f.setData("text",""),e.dragImage&&f.setDragImage&&f.setDragImage(e.dragImage,0,0),j=(b=a(this)).addClass("sortable-dragging").attr("aria-grabbed","true").index(),c=b.outerHeight(),k=a(this).parent()}).on("dragend.h5s",function(){b&&(b.removeClass("sortable-dragging").attr("aria-grabbed","false").show(),d.detach(),l=a(this).parent(),(j!==b.index()||k.get(0)!==l.get(0))&&b.parent().triggerHandler("sortupdate",{item:b,oldindex:j,startparent:k,endparent:l}),b=null,c=null)}).not("a[href], img").on("selectstart.h5s",function(){return e.handle&&!i?!0:(this.dragDrop&&this.dragDrop(),!1)}).end().add([this,n]).on("dragover.h5s dragenter.h5s drop.h5s",function(f){if(!m.is(b)&&e.connectWith!==a(b).parent().data("connectWith"))return!0;if("drop"===f.type)return f.stopPropagation(),d.filter(":visible").after(b),b.trigger("dragend.h5s"),!1;if(f.preventDefault(),f.originalEvent.dataTransfer.dropEffect="move",m.is(this)){var g=a(this).outerHeight();if(e.forcePlaceholderSize&&n.height(c),g>c){var h=g-c,i=a(this).offset().top;if(n.index()<a(this).index()&&f.originalEvent.pageY<i+h)return!1;if(n.index()>a(this).index()&&f.originalEvent.pageY>i+g-h)return!1}b.hide(),a(this)[n.index()<a(this).index()?"after":"before"](n),d.not(n).detach()}else d.is(this)||a(this).children(e.items).length||(d.detach(),a(this).append(n));return!1})})}}(jQuery),function(a){var b={topSpacing:0,bottomSpacing:0,className:"is-sticky",wrapperClassName:"sticky-wrapper",center:!1,getWidthFrom:"",responsiveWidth:!1},c=a(window),d=a(document),e=[],f=c.height(),g=function(){for(var b=c.scrollTop(),g=d.height(),h=g-f,i=b>h?h-b:0,j=0;j<e.length;j++){var k=e[j],l=k.stickyWrapper.offset().top,m=l-k.topSpacing-i;if(m>=b)null!==k.currentTop&&(k.stickyElement.css("position","").css("top",""),k.stickyElement.trigger("sticky-end",[k]).parent().removeClass(k.className),k.currentTop=null);else{var n=g-k.stickyElement.outerHeight()-k.topSpacing-k.bottomSpacing-b-i;0>n?n+=k.topSpacing:n=k.topSpacing,k.currentTop!=n&&(k.stickyElement.css("position","fixed").css("top",n),"undefined"!=typeof k.getWidthFrom&&k.stickyElement.css("width",a(k.getWidthFrom).width()),k.stickyElement.trigger("sticky-start",[k]).parent().addClass(k.className),k.currentTop=n)}}},h=function(){f=c.height();for(var b=0;b<e.length;b++){var d=e[b];"undefined"!=typeof d.getWidthFrom&&d.responsiveWidth===!0&&d.stickyElement.css("width",a(d.getWidthFrom).width())}},i={init:function(c){var d=a.extend({},b,c);return this.each(function(){var c=a(this),f=c.attr("id"),g=(f?f+"-"+b.wrapperClassName:b.wrapperClassName,a("<div></div>").attr("id",f+"-sticky-wrapper").addClass(d.wrapperClassName));c.wrapAll(g),d.center&&c.parent().css({width:c.outerWidth(),marginLeft:"auto",marginRight:"auto"}),"right"==c.css("float")&&c.css({"float":"none"}).parent().css({"float":"right"});var h=c.parent();h.css("height",c.outerHeight()),e.push({topSpacing:d.topSpacing,bottomSpacing:d.bottomSpacing,stickyElement:c,currentTop:null,stickyWrapper:h,className:d.className,getWidthFrom:d.getWidthFrom,responsiveWidth:d.responsiveWidth})})},update:g,unstick:function(){return this.each(function(){for(var b=a(this),c=-1,d=0;d<e.length;d++)e[d].stickyElement.get(0)==b.get(0)&&(c=d);-1!=c&&(e.splice(c,1),b.unwrap(),b.removeAttr("style"))})}};window.addEventListener?(window.addEventListener("scroll",g,!1),window.addEventListener("resize",h,!1)):window.attachEvent&&(window.attachEvent("onscroll",g),window.attachEvent("onresize",h)),a.fn.sticky=function(b){return i[b]?i[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" does not exist on jQuery.sticky"):i.init.apply(this,arguments)},a.fn.unstick=function(b){return i[b]?i[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" does not exist on jQuery.sticky"):i.unstick.apply(this,arguments)},a(function(){setTimeout(g,0)})}(jQuery),jQuery(document).ready(function(){jQuery("#show-full-list-button").click(function(){jQuery("#future-read-list").hasClass("collapsed")?(jQuery("#future-read-list").addClass("expanded").removeClass("collapsed"),jQuery(this).text("Less Books"),visibleLooper()):(jQuery("#future-read-list").addClass("collapsed").removeClass("expanded"),jQuery(this).text("More Books"),jQuery("#future-read-list .overflow").each(function(){jQuery(this).removeClass("animate")}))}),jQuery("#finished-read-list, #current-read-list, #future-read-list").sortable({connectWith:".connected",forcePlaceholderSize:!0,items:":not(.disabled)"}).bind("sortupdate",function(a,b){var c=b.item[0].id;switch(jQuery(this).attr("id")){case"future-read-list":updateFutureList();break;case"current-read-list":updateCurrentList(c);break;case"finished-read-list":updateFinishedList(c)}});var a=!1;jQuery("#current-read-list .book").mousedown(function(){jQuery(window).mousemove(function(){a=!0,jQuery(window).unbind("mousemove"),jQuery("#finished-read").slideDown("slow",function(){jQuery(".sticky--cr").sticky("update"),console.log("foo")})})}),jQuery("#logged-out-warning a").click(function(){jQuery("#logged-out-warning").addClass("animate-close").removeClass("animate-open")});var b=Math.ceil(jQuery("#site-footer").outerHeight(!0)),c=Math.ceil(parseInt(jQuery("#site-content").css("padding-bottom"))),d=b+c;jQuery(".sticky--wtr, .sticky--cr").outerWidth(jQuery(".sticky--wtr").outerWidth()),jQuery(window).width()>745&&jQuery(".sticky--cr").sticky({topSpacing:0,bottomSpacing:d}),jQuery(".sticky--wtr").sticky({topSpacing:0,bottomSpacing:d}),jQuery("#current-read-sticky-wrapper").css("height","auto"),jQuery(window).scroll(function(){visibleLooper()})});